# Переходим на систему с Marzban-Nodes.

Поскольку marzban-nodes сам регулирует нагрузку и распределение на сервера, таблица servers нам скорее всего не понадобится.

Твои задачи:

1. Переписать логику добавления юзера на сервер и всю логику с серверами под Marzban-Nodes.
2. Интегрировать Marzban-Nodes таким образом, чтобы была возможность добавления нескольких серверов и масштабирования.
3. Юзер добавлялся на менее загруженный сервер из всех доступных
4. Сделать все максимально логичным и для уровня продакшена.

---

Если нужно, таблицу servers оставь.
Если что-то стоит уточнить - задай вопросы сейчас, а только потом делай. 

---

# Ответы на вопросы

1. Один главный сервер Marzban, на нем же хостится и этот бот и датабаза сразу, он будет управлять несколькими нодами серверов. Пока добавил только 1 ноду.
2. При создании Marzban автоматически распределяет юзеров по нодам по дефолту, но на будущее сделай чтоб эта функция принимала параметр который будет отвечать за то чтоб это контролировать (возможно потом добавлю опцию выбора сервера). Нагрухка сервера определяется по формуле которую надо составить, ее вывести используя значения сервера типа CPU load, Memory used, etc.
3. Сделай как считаешь лучшим.
4. Пока ничего не переносим, делаем логику.
5. Нет, 1 конфиг = 1 ссылка для каждого юзера.